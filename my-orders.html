
<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<title>Ø·Ù„Ø¨Ø§ØªÙŠ - Ø£Ø³ÙˆØ§Ù‚ Ø¯ÙŠØ± Ø§Ù„Ø¹Ø³Ù„</title>

<!-- Ø§Ù„Ø®Ø·ÙˆØ· -->
<link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700&display=swap" rel="stylesheet">

<!-- CSS Ø£Ø³Ø§Ø³ÙŠ -->
<style>
body {
    font-family: 'Cairo', sans-serif;
    background: linear-gradient(180deg,#0b5fa5,#0f8f6e);
    color: #fff;
    margin: 0;
    padding: 0 20px;
}
h1 {
    text-align: center;
    margin: 30px 0;
}
.order {
    background: #083d66;
    padding: 15px;
    margin-bottom: 15px;
    border-radius: 10px;
}
.order h3 {
    margin: 0 0 10px 0;
    color: #6bcf63;
}
.order p {
    margin: 5px 0;
}
</style>

<!-- Ù…ÙƒØªØ¨Ø§Øª Firebase -->
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>

<!-- Ø¥Ø¹Ø¯Ø§Ø¯ Firebase -->
<script>
const firebaseConfig = {
  apiKey: "Ø¶Ø¹Ù‡Ù†Ø§",
  authDomain: "Ø¶Ø¹Ù‡Ù†Ø§",
  projectId: "Ø¶Ø¹Ù‡Ù†Ø§"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();
</script>

</head>
<body>

<h1>ðŸ›’ Ø·Ù„Ø¨Ø§ØªÙŠ</h1>
<div id="ordersContainer"></div>

<script>
// Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
auth.onAuthStateChanged(user => {

  if(!user){
    alert("ÙŠØ¬Ø¨ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø£ÙˆÙ„Ø§Ù‹");
    window.location = "login.html"; // Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„ØªÙˆØ¬ÙŠÙ‡ Ù„ØµÙØ­Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
    return;
  }

  // Ø¬Ù„Ø¨ Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ù…Ù† Firestore
  db.collection("orders")
    .where("userId", "==", user.uid)
    .orderBy("createdAt", "desc")
    .get()
    .then(snapshot => {
      const container = document.getElementById("ordersContainer");
      if(snapshot.empty){
        container.innerHTML = "<p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ø·Ù„Ø¨Ø§Øª Ø¨Ø¹Ø¯.</p>";
      }
      snapshot.forEach(doc => {
        const order = doc.data();
        let html = `<div class="order">
                        <h3>Ø·Ù„Ø¨ Ø¨ØªØ§Ø±ÙŠØ®: ${order.createdAt.toDate().toLocaleString()}</h3>
                        <p>Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª:</p>
                        <ul>`;
        order.items.forEach(item => {
          html += `<li>${item.name} - ${item.price} JOD</li>`;
        });
        html += `</ul></div>`;
        container.innerHTML += html;
      });
    })
    .catch(err => console.error(err));

});
</script>

</body>
</html>
